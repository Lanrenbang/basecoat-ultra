(()=>{const n=i=>{const t=i.querySelector(":scope > button"),a=i.querySelector(":scope > [data-popover]");if(!t||!a){const e=[];t||e.push("trigger"),a||e.push("content"),console.error(`Popover initialisation failed. Missing element(s): ${e.join(", ")}`,i);return}t.hasAttribute("aria-expanded")||t.setAttribute("aria-expanded","false"),a.hasAttribute("aria-hidden")||a.setAttribute("aria-hidden","true");const r=e=>{i.contains(e.target)||s()},s=(e=!0)=>{t.getAttribute("aria-expanded")!=="false"&&(t.setAttribute("aria-expanded","false"),a.setAttribute("aria-hidden","true"),document.removeEventListener("click",r),e&&t.focus())},d=()=>{document.dispatchEvent(new CustomEvent("basecoat:popover",{detail:{source:i}}));const e=a.querySelector("[autofocus]");e&&a.addEventListener("transitionend",()=>{e.focus()},{once:!0}),t.setAttribute("aria-expanded","true"),a.setAttribute("aria-hidden","false"),setTimeout(()=>{document.addEventListener("click",r)},0)};t.addEventListener("click",()=>{t.getAttribute("aria-expanded")==="true"?s():d()}),i.addEventListener("keydown",e=>{e.key==="Escape"&&s()}),document.addEventListener("basecoat:popover",e=>{e.detail.source!==i&&s(!1)}),i.dataset.popoverInitialized=!0,i.dispatchEvent(new CustomEvent("basecoat:initialized"))};window.basecoat&&window.basecoat.register("popover",".popover:not([data-popover-initialized])",n)})();
